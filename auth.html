<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Accede a tu cuenta de Café Valdore - 
  Inicia sesión o regístrate para gestionar tus pedidos, favoritos y recibir ofertas exclusivas de nuestros cafés.">
    <!-- PRECONNECT para Firebase (agregar esto) -->
  <link rel="preconnect" href="https://www.gstatic.com">
  <link rel="preconnect" href="https://apis.google.com">
  <link rel="preconnect" href="https://firestore.googleapis.com">
  
  <title>Iniciar Sesión - Café Valdore</title>
  <link rel="stylesheet" href="auth.css">
  
  <!-- Importamos el JS con defer -->
  <script src="auth.js" type="module"></script>
</head>
<body>
  <div class="auth-container">
    <a href="index.html" class="logo">
  <img src="logo.webp" alt="Café Valdore" style="height: 120px;">
</a>
    
    <div id="errorMsg" class="error" style="display: none;"></div>
    <div id="successMsg" class="success" style="display: none;"></div>
    
    <!-- Formulario de Login -->
    <div id="loginForm" class="auth-form active">
      <h2>Iniciar Sesión</h2>
      <input type="email" id="loginEmail" placeholder="Correo electrónico" required>
      <input type="password" id="loginPassword" placeholder="Contraseña" required>
      <button id="loginBtn">Iniciar Sesión</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('register')">¿No tienes cuenta? Regístrate</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('forgot')">¿Olvidaste tu contraseña?</button>
    </div>

    <!-- Formulario de Registro -->
    <div id="registerForm" class="auth-form">
      <h2>Registrarse</h2>
      <input type="text" id="registerName" placeholder="Nombre completo" required>
      <input type="email" id="registerEmail" placeholder="Correo electrónico" required>
      <input type="password" id="registerPassword" placeholder="Contraseña (mín. 6 caracteres)" required>
      <button id="registerBtn">Crear Cuenta</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">¿Ya tienes cuenta? Inicia sesión</button>
    </div>

    <!-- Formulario de Recuperación de Contraseña -->
    <div id="forgotForm" class="auth-form">
      <h2>Recuperar Contraseña</h2>
      <p>Ingresa tu correo electrónico para recibir un enlace de restablecimiento</p>
      <input type="email" id="forgotEmail" placeholder="Correo electrónico" required>
      <button id="sendResetBtn">Enviar Enlace</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Volver al Inicio de Sesión</button>
    </div>

    <!-- Formulario de Cambio de Contraseña (solo para usuarios autenticados) -->
    <div id="changePassForm" class="auth-form">
      <h2>Cambiar Contraseña</h2>
      <input type="password" id="currentPassword" placeholder="Contraseña actual" required>
      <input type="password" id="newPassword" placeholder="Nueva contraseña" required>
      <input type="password" id="confirmPassword" placeholder="Confirmar nueva contraseña" required>
      <button id="changePassBtn">Cambiar Contraseña</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Cancelar</button>
    </div>

    <a href="index.html" class="back-link">← Volver a la tienda</a>
  </div>

  <script type="module" src="main.js"></script>
<script>
// Cargar Firebase solo cuando el usuario interactúe o después de LCP
function loadFirebase() {
    const script = document.createElement('script');
    script.type = 'module';
    script.src = 'firebaseconfig.js';
    document.body.appendChild(script);
}

// Cargar después de 4 segundos O cuando el usuario haga hover en botones de auth
setTimeout(loadFirebase, 4000);
document.getElementById('authBtn')?.addEventListener('mouseover', loadFirebase, { once: true });
document.getElementById('carritoBtn')?.addEventListener('mouseover', loadFirebase, { once: true });
</script>

</body>
</html>